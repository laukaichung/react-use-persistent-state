{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AAC5C,OAAO,WAAW,MAAM,aAAa,CAAC;AAEtC,MAAM,kBAAkB,GAAG,CACvB,GAAW,EACX,YAAe,EACoB,EAAE;IACrC,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,QAAQ,CAAC;QAC/B,QAAQ,EAAE,KAAK;QACf,KAAK,EAAE,YAAY;KACtB,CAAC,CAAC;IACH,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,KAAK,CAAC;IAElC,SAAe,cAAc;;YACzB,IAAI;gBACA,MAAM,YAAY,GAAG,MAAM,WAAW,CAAC,OAAO,CAAI,GAAG,CAAC,CAAC;gBACvD,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,IAAI,YAAY,EAAE,CAAC,CAAC;aACrE;YAAC,OAAO,GAAG,EAAE;gBACV,OAAO,CAAC,KAAK,CAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC;gBACzC,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC;aACrD;QACL,CAAC;KAAA;IAED,SAAe,aAAa,CAAC,QAAW;;YACpC,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;YAC9C,MAAM,WAAW,CAAC,OAAO,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QAC7C,CAAC;KAAA;IAED,SAAS,CAAC,GAAG,EAAE;QACX,cAAc,EAAE,CAAC;IACrB,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,OAAO,CAAC,KAAK,EAAE,aAAa,EAAE,QAAQ,CAAC,CAAC;AAC5C,CAAC,CAAC;AAEF,eAAe,kBAAkB,CAAC","sourcesContent":["import { useEffect, useState } from \"react\";\nimport localForage from \"localforage\";\n\nconst usePersistentState = <T>(\n    key: string,\n    defaultValue: T\n): [T, (newValue: T) => void, boolean] => {\n    const [state, setState] = useState({\n        hydrated: false,\n        value: defaultValue,\n    });\n    const { hydrated, value } = state;\n\n    async function getFromStorage() {\n        try {\n            const storageValue = await localForage.getItem<T>(key);\n            setState({ hydrated: true, value: storageValue || defaultValue });\n        } catch (err) {\n            console.error(\"usePersistentState\", err);\n            setState({ hydrated: true, value: defaultValue });\n        }\n    }\n\n    async function syncToStorage(newValue: T) {\n        setState({ hydrated: true, value: newValue });\n        await localForage.setItem(key, newValue);\n    }\n\n    useEffect(() => {\n        getFromStorage();\n    }, []);\n\n    return [value, syncToStorage, hydrated];\n};\n\nexport default usePersistentState;"]}